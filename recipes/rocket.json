{
    "name": "rocket-ubuntu",
    "description": "rocket chip and rocket tools on Ubunut 18.04",
    
    "region": "us-east-2",

    "user": "ubuntu",
    "instance_type": "c4.2xlarge",

    "base_image": {
        "doc-string": "These are the U18.04 amd64 ebs images as of 17-Feb-2020",
        "us-east-2": "ami-0367b500fdcac0edc",
        "us-west-2": "ami-0d1cd67c26f5fca19"
    },

    "volume_size": 50,
    
    "uploads": {
        "doc-string": "Everthing in the source dir will be uploaded to target_directory",
        "source": "/home/macd/source",
        "target": "/home/ubuntu/target"
    },

    "commands": [
        "sudo apt-get update",
        "sudo apt-get upgrade -y",
        "sudo apt-get update",
        "sudo snap install ripgrep --classic",
        "sudo apt-get install zip -y",
        "curl -s 'https://get.sdkman.io' | bash",
        "echo 'source ~/.sdkman/bin/sdkman-init.sh' >> envx",
        "sdk install java 11.0.6.hs-adpt",
        "sdk install sbt",
        "sdk install scala 2.12.10",
        "rm envx",
        "sudo apt-get install autoconf -y",
        "sudo apt-get install automake -y",
        "sudo apt-get install autotools-dev -y",
        "sudo apt-get install curl -y",
        "sudo apt-get install wget -y",
        "sudo apt-get install python3 -y",
        "sudo apt-get install emacs -y",
        "sudo apt-get install git -y",
        "sudo apt-get install libmpc-dev -y",
        "sudo apt-get install libmpfr-dev -y",
        "sudo apt-get install libgmp-dev -y",
        "sudo apt-get install gawk -y",
        "sudo apt-get install python -y",
        "sudo apt-get install build-essential -y",
        "sudo apt-get install bison -y",
        "sudo apt-get install flex -y",
        "sudo apt-get install texinfo -y",
        "sudo apt-get install gperf -y",
        "sudo apt-get install libtool -y",
        "sudo apt-get install patchutils -y",
        "sudo apt-get install pkg-config -y",
        "sudo apt-get install glib2.0 -y",
        "sudo apt-get install libpixman-1.dev -y",
        "sudo apt-get install bc -y",
        "sudo apt-get install zlib1g-dev -y",
        "sudo apt-get install libexpat-dev -y",
        "sudo apt-get install device-tree-compiler -y",
        "sudo apt-get install bridge-utils -y",
        "sudo mkdir /opt/riscv",
        "echo 'export PATH=$PATH:/opt/riscv/bin' >> .bashrc",
        "echo 'export PATH=$PATH:/opt/riscv/bin' >> envx",
        "echo 'export RISCV=/opt/riscv' >> .bashrc",
        "echo 'export RISCV=/opt/riscv' >> envx",
        "wget https://download.qemu.org/qemu-4.2.0.tar.xz",
        "tar xf qemu-4.2.0.tar.xz",
        "cd qemu-4.2.0; ./configure --target-list='riscv32-softmmu,riscv32-linux-user,riscv64-softmmu,riscv64-linux-user'",
        "cd qemu-4.2.0; make -j8",
        "cd qemu-4.2.0; sudo make install",
        "git clone --recursive https://github.com/michaeljclark/busybear-linux.git",
        "cd busybear-linux; make -j8",
        "wget https://kernel.org/pub/linux/kernel/v5.x/linux-5.5.5.tar.xz",
        "tar xf linux-5.5.5.tar.xz",
        "cp busybear-linux/conf/linux.config linux-5.5.5/.config",
        "cd linux-5.5.5 ; make ARCH=riscv olddefconfig",
        "cd linux-5.5.5 ; make ARCH=riscv CROSS_COMPILE=riscv64-unknown-linux-gnu- vmlinux -j8",
        "git clone https://github.com/chipsalliance/rocket-chip.git",
        "cd rocket-chip; git submodule update --init",
        "git clone https://github.com/freechipsproject/rocket-tools",
        "cd rocket-tools; git submodule update --init --recursive",
        "cd rocket-tools; sudo -E ./build.sh"
    ]
}
